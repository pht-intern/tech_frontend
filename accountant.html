<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8"/>
    <meta name="viewport" content="width=device-width,initial-scale=1"/>
    <title>Dashboard - Techtitans (Accountant)</title>
    <link rel="icon" type="image/x-icon" href="images/favicon.ico">
    <link href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0-beta3/css/all.min.css" rel="stylesheet"/>
    <link href="css/accountant.css" rel="stylesheet"/>
</head>
<body>

    <aside class="sidebar" role="navigation">
        <div class="brand">
            <img src="images/Logo.svg" alt="Tech Titans Logo" style="height: 120px; width: auto; max-width: 100%;">
        </div>

        <nav class="nav" id="sideNav">
            <a href="#" data-tab="dashboard" class="active"><i class="fas fa-th-large"></i> Dashboard</a>
            <a href="#" data-tab="itemsList"><i class="fas fa-list"></i> Products</a>
            <a href="#" data-tab="addItem"><i class="fas fa-plus-circle"></i> Add Product</a>
            <a href="#" data-tab="createQuotation"><i class="fas fa-file-invoice-dollar"></i> Create Quotation</a>
            <a href="#" data-tab="viewHistory"><i class="fas fa-history"></i> History</a>
            <a href="#" data-tab="viewCustomers" id="navViewCustomers"><i class="fas fa-users"></i> Customers</a>  
        </nav>

        <div class="user">
            <div class="avatar" id="userAvatar">A</div>
            <div class="meta" style="flex: 1;"><strong id="userRoleDisplay">Accountant</strong><small id="userEmailDisplay">accountant@rolewise.app</small></div>
        </div>
        <button class="btn danger" id="logoutBtn" style="margin-top: 8px; width: 100%; padding: 8px; font-size: 13px;"><i class="fas fa-sign-out-alt"></i> Logout</button>
    </aside>

    <main class="main">
        <header class="header">
            <h1 id="headerTitle">Accountant Dashboard</h1>
        </header>

        <section id="dashboard" class="content-section">
            <div class="section-tabs" id="dashboardTabs">
                <button class="tab-btn" data-tab="itemsList">Products</button>
                <button class="tab-btn" data-tab="addItem">Create Product</button>
                <button class="tab-btn" data-tab="createQuotation">Create Quotation</button>
                <button class="tab-btn" data-tab="viewHistory">History</button>
                <button class="tab-btn" data-tab="viewCustomers" id="tabViewCustomers">Customers</button> 
            </div>

            <div class="card">
                <h2>Overview</h2>
                <p class="muted">Quick summary of products, quotations and activity.</p>

                <div class="stats-grid" style="display:grid;grid-template-columns:repeat(4,1fr);gap:14px;margin-top:14px">
                    <div class="card" style="padding:16px; border-left: 4px solid #3A648C;">
                        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
                            <h3 style="margin:0; font-size:16px; color:#34495E;">Products</h3>
                            <i class="fas fa-box" style="color:#90A4AE; font-size:20px;"></i>
                        </div>
                        <div id="summaryItemsCount" style="font-size:32px; font-weight:bold; color:#34495E;">—</div>
                        <div class="muted" style="font-size:12px; margin-top:4px;">Total products in system</div>
                    </div>

                    <div class="card" style="padding:16px; border-left: 4px solid #27AE60;">
                        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
                            <h3 style="margin:0; font-size:16px; color:#34495E;">Quotations</h3>
                            <i class="fas fa-file-invoice-dollar" style="color:#90A4AE; font-size:20px;"></i>
                        </div>
                        <div id="summaryQuotationsCount" style="font-size:32px; font-weight:bold; color:#34495E;">—</div>
                        <div class="muted" style="font-size:12px; margin-top:4px;">Total quotations created</div>
                    </div>

                    <div class="card" style="padding:16px; border-left: 4px solid #E74C3C;" id="summaryLogsCard">
                        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
                            <h3 style="margin:0; font-size:16px; color:#34495E;">Activity Logs</h3>
                            <i class="fas fa-clipboard-list" style="color:#90A4AE; font-size:20px;"></i>
                        </div>
                        <div id="summaryLogsCount" style="font-size:32px; font-weight:bold; color:#34495E;">—</div>
                        <div class="muted" style="font-size:12px; margin-top:4px;">Total activity records</div>
                    </div>

                    <div class="card" style="padding:16px; border-left: 4px solid #F39C12;">
                        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
                            <h3 style="margin:0; font-size:16px; color:#34495E;">Total Value</h3>
                            <i class="fas fa-rupee-sign" style="color:#90A4AE; font-size:20px;"></i>
                        </div>
                        <div id="summaryTotalValue" style="font-size:32px; font-weight:bold; color:#34495E;">—</div>
                        <div class="muted" style="font-size:12px; margin-top:4px;">Total quotation value</div>
                    </div>

                    <div class="card" style="padding:16px; border-left: 4px solid #9B59B6;">
                        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
                            <h3 style="margin:0; font-size:16px; color:#34495E;">Customers</h3>
                            <i class="fas fa-users" style="color:#90A4AE; font-size:20px;"></i>
                        </div>
                        <div id="summaryCustomersCount" style="font-size:32px; font-weight:bold; color:#34495E;">—</div>
                        <div class="muted" style="font-size:12px; margin-top:4px;">Unique customers</div>
                    </div>

                    <div class="card" style="padding:16px; border-left: 4px solid #1ABC9C;">
                        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
                            <h3 style="margin:0; font-size:16px; color:#34495E;">This Month</h3>
                            <i class="fas fa-calendar-alt" style="color:#90A4AE; font-size:20px;"></i>
                        </div>
                        <div id="summaryMonthlyQuotations" style="font-size:32px; font-weight:bold; color:#34495E;">—</div>
                        <div class="muted" style="font-size:12px; margin-top:4px;">Quotations this month</div>
                    </div>

                    <div class="card" style="padding:16px; border-left: 4px solid #E67E22;">
                        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
                            <h3 style="margin:0; font-size:16px; color:#34495E;">Monthly Value</h3>
                            <i class="fas fa-chart-line" style="color:#90A4AE; font-size:20px;"></i>
                        </div>
                        <div id="summaryMonthlyValue" style="font-size:32px; font-weight:bold; color:#34495E;">—</div>
                        <div class="muted" style="font-size:12px; margin-top:4px;">This month's total value</div>
                    </div>

                    <div class="card" style="padding:16px; border-left: 4px solid #3498DB;">
                        <div style="display:flex; justify-content:space-between; align-items:center; margin-bottom:8px;">
                            <h3 style="margin:0; font-size:16px; color:#34495E;">Avg. Quotation</h3>
                            <i class="fas fa-calculator" style="color:#90A4AE; font-size:20px;"></i>
                        </div>
                        <div id="summaryAvgQuotation" style="font-size:32px; font-weight:bold; color:#34495E;">—</div>
                        <div class="muted" style="font-size:12px; margin-top:4px;">Average quotation value</div>
                    </div>
                </div>

                <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(300px,1fr));gap:14px;margin-top:20px">
                    <div class="card" style="padding:16px;">
                        <h3 style="margin:0 0 12px 0; font-size:18px; color:#34495E;">Recent Quotations</h3>
                        <div id="recentQuotationsList" style="max-height:200px; overflow-y:auto;">
                            <p class="muted" style="text-align:center; padding:20px;">Loading...</p>
                        </div>
                    </div>

                    <div class="card" style="padding:16px;">
                        <h3 style="margin:0 0 12px 0; font-size:18px; color:#34495E;">Recent Activity</h3>
                        <div id="recentActivityList" style="max-height:200px; overflow-y:auto;">
                            <p class="muted" style="text-align:center; padding:20px;">Loading...</p>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="addItem" class="content-section" style="display:none">
            <div class="section-tabs">
                <button class="tab-btn" data-tab="itemsList">Products</button>
                <button class="tab-btn active" data-tab="addItem">Create Product</button>
                <button class="tab-btn" data-tab="createQuotation">Create Quotation</button>
                <button class="tab-btn" data-tab="viewHistory">History</button>
                <button class="tab-btn" data-tab="viewCustomers">Customers</button> 
            </div>

            <div class="card">
                <div style="display: flex; justify-content: space-between; align-items: center;">
                    <h2>Add New Product</h2>
                    <input type="file" id="importCsvInput" accept=".csv" style="display:none" onchange="handleCsvImport(event)">
                    <button class="btn" onclick="document.getElementById('importCsvInput').click()"><i class="fas fa-file-import"></i> Import CSV</button>
                </div>
                <p class="muted">Enter the details of the new product. Product ID will be auto-generated.</p>

                <form id="addItemForm" class="form-grid-2" style="margin-top:12px">
                    <div class="form-field">
                        <label for="product-id">Product ID</label>
                        <input type="text" id="product-id" readonly>
                    </div>

                    <div class="form-field">
                        <label for="item-url">Website URL <span class="muted">(Must be unique)</span></label>
                        <input type="url" id="item-url" placeholder="https://example.com/product-page" required>
                    </div>

                    <div class="form-field">
                        <label for="product-name">Product Name</label>
                        <input type="text" id="product-name" placeholder="e.g. Office PC 01" required>
                    </div>

                    <div class="form-field">
                        <label for="type">Type</label>
                        <input type="text" id="type" placeholder="e.g. Laptop, Desktop" required>
                    </div>

                    <div class="form-field">
                        <label for="price">Price (INR)</label>
                        <input type="number" id="price" placeholder="e.g. 105999.00" required min="0" step="0.01">
                    </div>
                    
                    <div class="form-field">
                        <label for="gst">GST (%)</label>
                        <input type="number" id="gst" placeholder="e.g. 18" min="0" max="100" step="0.01">
                    </div> 

                    <div class="form-field" style="grid-column: 1 / 3;">
                        <label for="description">Description</label>
                        <textarea id="description" placeholder="e.g. Core i7, 16GB RAM, 1TB SSD, RTX 3080"></textarea>
                    </div>

                    <div style="grid-column: 1 / 3; display:flex;justify-content:flex-end;gap:8px;">
                        <button type="reset" class="btn">Reset</button>
                        <button type="submit" class="btn primary">Add Product</button>
                    </div>
                </form>
            </div>
        </section>

        <section id="itemsList" class="content-section" style="display:none">
            <div class="section-tabs">
                <button class="tab-btn active" data-tab="itemsList">Products</button>
                <button class="tab-btn" data-tab="addItem">Create Product</button>
                <button class="tab-btn" data-tab="createQuotation">Create Quotation</button>
                <button class="tab-btn" data-tab="viewHistory">History</button>
                <button class="tab-btn" data-tab="viewCustomers">Customers</button> 
            </div>

            <div class="card" style="flex-grow: 1;">
                <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 12px;">
                    <h2>Products</h2>
                    <button class="btn" onclick="exportItemsToCsv()"><i class="fas fa-file-export"></i> Export CSV</button>
                </div>
                <p class="muted">List of products currently available in the system. **(Search by Name or ID below)**</p>
                
                <div style="margin-top: 12px; margin-bottom: 18px;">
                    <input type="text" id="productListSearchInput" placeholder="Search products by Name or ID..." style="width:100%;padding:10px;border-radius:8px;border:1px solid var(--border)">
                </div>

                <div style="margin-top:12px; overflow:auto; flex-grow: 1;">
                    <table class="data-table" id="itemsTable">
                        <thead>
                            <tr>
                                <th>Product ID</th>
                                <th>Product Name</th>
                                <th>Type</th>
                                <th>Description</th>
                                <th>Website Link</th>
                                <th>Price (₹)</th>
                                <th>GST (%)</th>
                                <th>Total Value (₹)</th>
                                <th>Added By</th>
                                <th>Date Added</th>
                                <th>Actions</th>
                            </tr>
                        </thead>
                        <tbody id="itemsListBody"></tbody>
                    </table>
                    <p id="noItemsMessage" class="muted" style="text-align:center;padding:18px;display:none;">No products currently in the system. Use 'Create Product' to add one.</p>
                </div>
                <div id="itemsPagination" style="display: flex; justify-content: center; align-items: center; margin-top: 20px; padding: 20px; background: #f8f9fa; border-radius: 12px; gap: 8px; flex-wrap: wrap;">
                    <button id="itemsPrevBtn" class="pagination-btn" onclick="goToItemsPage(-1)" disabled>
                        <i class="fas fa-chevron-left"></i> Previous
                    </button>
                    <div id="itemsPageNumbers" style="display: flex; gap: 6px; align-items: center;"></div>
                    <button id="itemsNextBtn" class="pagination-btn" onclick="goToItemsPage(1)" disabled>
                        Next <i class="fas fa-chevron-right"></i>
                    </button>
                    <div id="itemsPageInfo" style="margin-left: 12px; padding: 8px 12px; background: white; border-radius: 8px; font-size: 13px; color: #7f8c8d; border: 1px solid #e0e0e0;"></div>
                </div>
                <style>
                    .pagination-btn {
                        padding: 10px 16px;
                        border: 1px solid #d0d7de;
                        border-radius: 8px;
                        background: white;
                        color: #34495e;
                        font-size: 14px;
                        font-weight: 500;
                        cursor: pointer;
                        transition: all 0.2s ease;
                        display: flex;
                        align-items: center;
                        gap: 6px;
                        box-shadow: 0 1px 3px rgba(0,0,0,0.05);
                    }
                    .pagination-btn:hover:not(:disabled) {
                        background: linear-gradient(135deg, #35b3e7 0%, #5490cc 100%);
                        color: white;
                        border-color: #35b3e7;
                        transform: translateY(-1px);
                        box-shadow: 0 4px 8px rgba(53, 179, 231, 0.3);
                    }
                    .pagination-btn:disabled {
                        opacity: 0.5;
                        cursor: not-allowed;
                        background: #f5f5f5;
                    }
                    .pagination-page-btn {
                        min-width: 40px;
                        height: 40px;
                        padding: 0;
                        border: 1px solid #d0d7de;
                        border-radius: 8px;
                        background: white;
                        color: #34495e;
                        font-size: 14px;
                        font-weight: 500;
                        cursor: pointer;
                        transition: all 0.2s ease;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        box-shadow: 0 1px 3px rgba(0,0,0,0.05);
                    }
                    .pagination-page-btn:hover {
                        background: #f0f7ff;
                        border-color: #35b3e7;
                        color: #35b3e7;
                        transform: translateY(-1px);
                        box-shadow: 0 2px 6px rgba(53, 179, 231, 0.2);
                    }
                    .pagination-page-btn.active {
                        background: linear-gradient(135deg, #35b3e7 0%, #5490cc 100%);
                        color: white;
                        border-color: #35b3e7;
                        font-weight: 600;
                        box-shadow: 0 4px 12px rgba(53, 179, 231, 0.4);
                        transform: scale(1.05);
                    }
                    .pagination-ellipsis {
                        min-width: 40px;
                        height: 40px;
                        display: flex;
                        align-items: center;
                        justify-content: center;
                        color: #7f8c8d;
                        font-size: 14px;
                        font-weight: 600;
                    }
                </style>
            </div>
        </section>

        <section id="createQuotation" class="content-section" style="display:none">
            <div class="section-tabs">
                <button class="tab-btn" data-tab="itemsList">Products</button>
                <button class="tab-btn" data-tab="addItem">Create Product</button>
                <button class="tab-btn active" data-tab="createQuotation">Create Quotation</button>
                <button class="tab-btn" data-tab="viewHistory">History</button>
                <button class="tab-btn" data-tab="viewCustomers">Customers</button> 
            </div>

            <div class="card" style="flex-grow: 1;">
                <h2>Create Quotation</h2>
                <div style="display:grid;grid-template-columns:2fr 1fr;gap:18px;margin-top:12px">
                    <div>
                        <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px">
                            <div>
                                <label class="muted">Customer Name <span class="muted">(Optional)</span></label>
                                <input id="cust-name" type="text" style="padding:10px;border-radius:8px;border:1px solid var(--border)" placeholder="Customer Name">
                            </div>
                            <div>
                                <label class="muted">Phone *</label>
                                <input id="phone-number" type="tel" maxlength="10" pattern="\d{10}" inputmode="numeric" style="padding:10px;border-radius:8px;border:1px solid var(--border)" placeholder="10-digit phone number" required>
                            </div>
                        </div>

                        <div style="display:grid;grid-template-columns:1fr 1fr;gap:12px; margin-top:10px">
                            <div>
                                <label class="muted">Email <span class="muted">(Optional)</span></label>
                                <input id="cust-email" type="email" style="padding:10px;border-radius:8px;border:1px solid var(--border)" placeholder="Email">
                            </div>
                        </div>

                        <div style="margin-top:10px">
                            <label class="muted">Address</label>
                            <textarea id="cust-address" style="width:100%;padding:10px;border-radius:8px;border:1px solid var(--border)" placeholder="Optional"></textarea>
                        </div>
                        
                        <div class="card" style="margin-top:12px">
                            <h2>Quotation Items</h2>
                            <table class="data-table">
                                <thead><tr><th>Item</th><th>Quantity</th><th>Unit Price</th><th>Total</th><th>GST Rate (%)</th><th>Actions</th></tr></thead>
                                <tbody id="quotationItemsBody"><tr id="quotationNoItemsRow"><td colspan="6" class="muted" style="text-align:center">No items added yet.</td></tr></tbody>
                            </table>
                        </div>
                    </div>

            <div>
                        <div class="card">
                            <h2>Add Items to Quotation</h2>
                            <div style="margin-top:8px">
                                <input id="itemSearchInput" placeholder="Search products by Name or ID..." style="width:100%;padding:10px;border-radius:8px;border:1px solid var(--border)">
                                <!-- Dynamic type filters for quotation items -->
                                <div id="quotationTypeFilters" style="margin-top:10px; display:flex; flex-wrap:wrap; gap:6px;"></div>
                                <style>
                                    .type-filter-btn.active {
                                        background: linear-gradient(135deg, #35b3e7 0%, #5490cc 100%) !important;
                                        color: white !important;
                                        border-color: #35b3e7 !important;
                                        font-weight: 600;
                                    }
                                    .type-filter-btn:hover {
                                        background: #f0f7ff !important;
                                        border-color: #35b3e7 !important;
                                    }
                                </style>
                                <div id="availableItemsList" style="margin-top:10px;max-height:340px;overflow:auto"></div>
                            </div>
                        </div>

                        <div class="card" style="margin-top:12px">
                            <h2>Summary</h2>
                            <div style="text-align:left; margin-top:10px;">
                                <p style="margin:8px 0;">Subtotal: <span class="right" id="subTotalDisplay">₹0.00</span></p>
                            </div>
                            <div style="font-size:20px;margin:12px 0; border-top:2px solid #ccc; padding-top:10px;">
                                <strong>Grand Total:</strong> <span class="right" id="grandTotalDisplay">₹0.00</span>
                                <p style="margin:8px 0; font-size:13px; color:#7f8c8d; font-style:italic;">Inclusive of GST</p>
                            </div>
                            <button id="createQuotationBtn" class="btn primary" style="width:100%"><i class="fas fa-file-invoice-dollar"></i> Create Quotation</button>
                        </div>
                    </div>
                </div>
            </div>
        </section>

        <section id="viewHistory" class="content-section" style="display:none">
            <div class="section-tabs">
                <button class="tab-btn" data-tab="itemsList">Products</button>
                <button class="tab-btn" data-tab="addItem">Create Product</button>
                <button class="tab-btn" data-tab="createQuotation">Create Quotation</button>
                <button class="tab-btn active" data-tab="viewHistory">History</button>
                <button class="tab-btn" data-tab="viewCustomers">Customers</button> 
            </div>

            <div class="card" style="flex-grow: 1; display: flex; flex-direction: column;">
                <h2>Quotation History</h2>
                <div style="margin-top:12px;overflow-y:auto; overflow-x:auto; flex-grow: 1; max-height: calc(100vh - 250px);">
                    <table class="data-table" id="historyTable">
                        <thead><tr><th>Quotation ID</th><th>Customer Name</th><th>Date Created</th><th>Total Amount (₹)</th><th>Items Count</th><th>Created By</th><th>Actions</th></tr></thead>
                        <tbody id="historyListBody"></tbody>
                    </table>
                    <p id="noHistoryMessage" class="muted" style="text-align:center;padding:18px;display:none">No quotations have been created yet.</p>
                </div>
                <div id="historyPagination" style="display: flex; justify-content: center; align-items: center; margin-top: 20px; padding: 20px; background: #f8f9fa; border-radius: 12px; gap: 8px; flex-wrap: wrap;">
                    <button id="historyPrevBtn" class="pagination-btn" onclick="goToHistoryPage(-1)" disabled>
                        <i class="fas fa-chevron-left"></i> Previous
                    </button>
                    <div id="historyPageNumbers" style="display: flex; gap: 6px; align-items: center;"></div>
                    <button id="historyNextBtn" class="pagination-btn" onclick="goToHistoryPage(1)" disabled>
                        Next <i class="fas fa-chevron-right"></i>
                    </button>
                    <div id="historyPageInfo" style="margin-left: 12px; padding: 8px 12px; background: white; border-radius: 8px; font-size: 13px; color: #7f8c8d; border: 1px solid #e0e0e0;"></div>
                </div>
            </div>
        </section>

        <section id="viewCustomers" class="content-section" style="display:none">
            <div class="section-tabs">
                <button class="tab-btn" data-tab="itemsList">Products</button>
                <button class="tab-btn" data-tab="addItem">Create Product</button>
                <button class="tab-btn" data-tab="createQuotation">Create Quotation</button>
                <button class="tab-btn" data-tab="viewHistory">History</button>
                <button class="tab-btn active" data-tab="viewCustomers">Customers</button>
               
            </div>

            <div class="card" style="flex-grow: 1; display: flex; flex-direction: column;">
                <h2>Customer List</h2>
                <p class="muted">List of all customers who have received a quotation.</p>
                <div style="margin-top:12px;overflow-y:auto; overflow-x:auto; flex-grow: 1; max-height: calc(100vh - 250px);">
                    <table class="data-table" id="customersTable">
                        <thead>
                            <tr>
                                <th>Name</th>
                                <th>Email</th>
                                <th>Phone</th>
                                <th>Address</th>
                                <th>Last Quotation Date</th>
                            </tr>
                        </thead>
                        <tbody id="customersListBody">
                            <tr><td colspan="5" class="muted" style="text-align:center">Customer data must be compiled from the Quotation History list.</td></tr>
                        </tbody>
                    </table>
                </div>
                <div id="customersPagination" style="display: flex; justify-content: center; align-items: center; margin-top: 20px; padding: 20px; background: #f8f9fa; border-radius: 12px; gap: 8px; flex-wrap: wrap;">
                    <button id="customersPrevBtn" class="pagination-btn" onclick="goToCustomersPage(-1)" disabled>
                        <i class="fas fa-chevron-left"></i> Previous
                    </button>
                    <div id="customersPageNumbers" style="display: flex; gap: 6px; align-items: center;"></div>
                    <button id="customersNextBtn" class="pagination-btn" onclick="goToCustomersPage(1)" disabled>
                        Next <i class="fas fa-chevron-right"></i>
                    </button>
                    <div id="customersPageInfo" style="margin-left: 12px; padding: 8px 12px; background: white; border-radius: 8px; font-size: 13px; color: #7f8c8d; border: 1px solid #e0e0e0;"></div>
                </div>
            </div>
        </section>
        <section id="viewLogs" class="content-section" style="display:none">
            <div class="section-tabs">
                <button class="tab-btn" data-tab="itemsList">Products</button>
                <button class="tab-btn" data-tab="addItem">Create Product</button>
                <button class="tab-btn" data-tab="createQuotation">Create Quotation</button>
                <button class="tab-btn" data-tab="viewHistory">History</button>
                <button class="tab-btn" data-tab="viewCustomers">Customers</button> 
            </div>

            <div class="card" style="flex-grow: 1; display: flex; flex-direction: column;">
                <h2>User Activity Logs</h2>
                <p class="muted">A chronological record of actions taken by users across roles. Owner/Admin/Manager can delete logs.</p>
                <div style="margin-top:12px;overflow-y:auto; overflow-x:auto; flex-grow: 1; max-height: calc(100vh - 250px);">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Timestamp</th>
                                <th>User</th>
                                <th>Role</th>
                                <th>Action</th>
                                <th>Details</th>
                            </tr>
                        </thead>
                        <tbody id="logsListBody"></tbody>
                    </table>
                    <p id="noLogsMessage" class="muted" style="text-align:center;padding:18px;display:none;">No user activity logs recorded yet.</p>
                </div>
                <div id="logsPagination" style="display: flex; justify-content: center; align-items: center; margin-top: 20px; padding: 20px; background: #f8f9fa; border-radius: 12px; gap: 8px; flex-wrap: wrap;">
                    <button id="logsPrevBtn" class="pagination-btn" onclick="goToLogsPage(-1)" disabled>
                        <i class="fas fa-chevron-left"></i> Previous
                    </button>
                    <div id="logsPageNumbers" style="display: flex; gap: 6px; align-items: center;"></div>
                    <button id="logsNextBtn" class="pagination-btn" onclick="goToLogsPage(1)" disabled>
                        Next <i class="fas fa-chevron-right"></i>
                    </button>
                    <div id="logsPageInfo" style="margin-left: 12px; padding: 8px 12px; background: white; border-radius: 8px; font-size: 13px; color: #7f8c8d; border: 1px solid #e0e0e0;"></div>
                </div>
            </div>
        </section>

        <section id="settings" class="content-section" style="display:none">
            <div class="section-tabs">
                <button class="tab-btn" data-tab="itemsList">Products</button>
                <button class="tab-btn" data-tab="addItem">Create Product</button>
                <button class="tab-btn" data-tab="createQuotation">Create Quotation</button>
                <button class="tab-btn" data-tab="viewHistory">History</button>
                <button class="tab-btn" data-tab="viewCustomers">Customers</button> 
            </div>

            <div class="card">
                <h2>Company Logo</h2>
                <p class="muted">Upload your company logo for use on generated quotations.</p>
                <div style="margin-top:18px">
                    <div style="display:flex; align-items:center; gap:15px">
                        <img id="logoPreview" src="" alt="Company Logo" style="height: 60px; max-width: 150px; object-fit: contain; border-radius: 4px; border: 1px solid var(--border); padding: 5px; display: none;">
                        <span id="noLogoText" class="muted" style="font-style: italic;">No logo uploaded.</span>
                    </div>
                    
                    <div style="display:flex; align-items:center; gap:15px; margin-top: 15px;">
                        <input type="file" id="logoUploadInput" accept="image/*" style="display:none" onchange="handleLogoUpload(event)">
                        <button class="btn" onclick="document.getElementById('logoUploadInput').click()"><i class="fas fa-upload"></i> Upload Logo</button>
                        <button class="btn danger" id="removeLogoBtn" style="display:none;"><i class="fas fa-trash-alt"></i> Remove Logo</button>
                    </div>
                    <small class="muted" style="display:block;margin-top:8px">Recommended size: Square aspect ratio, under 200KB.</small>
                </div>
            </div>

            <div class="card">
                <h2>Company/Brand Settings</h2>
                <p class="muted">Configuration of brand name for quotations.</p>
                
                <div style="margin-top:18px">
                    <div class="form-field" style="display:flex; align-items:center; gap:15px">
                        <label for="settings-brand-name" style="margin:0; width:150px">Brand Name</label>
                        <input type="text" id="settings-brand-name" placeholder="RoleWise Tech" style="width:250px; padding:8px" required>
                        <button class="btn primary" id="saveBrandNameBtn"><i class="fas fa-save"></i> Save Brand</button>
                    </div>
                    <small class="muted" style="display:block;margin-top:8px">This name will appear on all generated quotation PDFs.</small>
                </div>
            </div>

            <div class="card">
                <h2>Quotation Validity</h2>
                <p class="muted">Set the number of days a generated quotation is considered valid.</p>
                <div style="margin-top:18px">
                    <div class="form-field" style="display:flex; align-items:center; gap:15px">
                        <label for="settings-validity-days" style="margin:0; width:150px">Validity Days</label>
                        <input type="number" id="settings-validity-days" min="1" max="365" placeholder="30" style="width:100px; padding:8px" required>
                        <button class="btn primary" id="saveValidityBtn"><i class="fas fa-save"></i> Save Validity</button>
                    </div>
                    <small class="muted" style="display:block;margin-top:8px">The number of days a quotation will be valid from the date of creation. Currently: <strong id="validityDaysDisplay">30</strong> days.</small>
                </div>
            </div>

            <div class="card">
                <h2>Company GST ID</h2>
                <p class="muted">Your company's official GST Identification Number (GSTIN).</p>
                <div style="margin-top:18px">
                    <div class="form-field" style="display:flex; align-items:center; gap:15px">
                        <label for="settings-company-gst-id" style="margin:0; width:150px">Company GST ID</label>
                        <input type="text" id="settings-company-gst-id" maxlength="15" pattern="[A-Za-z0-9]{15}" placeholder="Unique Alphanumeric GSTIN" style="width:250px; padding:8px" required>
                        <button class="btn primary" id="saveCompanyGstIdBtn"><i class="fas fa-save"></i> Save GSTIN</button>
                    </div>
                    <small class="muted" style="display:block;margin-top:8px">This GSTIN will appear on all generated quotation PDFs as the seller's GST ID.</small>
                </div>
            </div>

        </section>

    </main>

    <div id="photoModal" aria-modal="true" role="dialog">
        <span id="closeModalBtn">&times;</span>
        <div id="modalImageContainer">
            <img id="modalImage" src="" alt="Enlarged Product Photo">
        </div>
    </div>

    <div id="quotationPdfTemplate">
        </div>

    <!-- Quotation View Modal -->
    <div id="quotationViewModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 10000; overflow-y: auto;">
        <div style="position: relative; max-width: 900px; margin: 20px auto; background: #fff; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.3);">
            <div style="position: sticky; top: 0; background: #fff; padding: 15px 20px; border-bottom: 1px solid #ddd; display: flex; justify-content: space-between; align-items: center; border-radius: 8px 8px 0 0; z-index: 1;">
                <h3 style="margin: 0; font-size: 18px; color: #34495E;">View Quotation</h3>
                <div style="display: flex; gap: 10px; align-items: center;">
                    <button id="closeQuotationModal" style="background: none; border: none; font-size: 24px; cursor: pointer; color: #666; padding: 0; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center;">&times;</button>
                </div>
            </div>
            <div id="quotationViewContent" style="padding: 20px; max-height: calc(100vh - 120px); overflow-y: auto; display: flex; justify-content: center; align-items: flex-start;">
                <!-- Quotation content will be inserted here -->
            </div>
        </div>
    </div>

    <!-- Edit Product Modal -->
    <div id="editProductModal" style="display: none; position: fixed; top: 0; left: 0; width: 100%; height: 100%; background: rgba(0,0,0,0.5); z-index: 10000; overflow-y: auto;">
        <div style="position: relative; max-width: 700px; margin: 20px auto; background: #fff; border-radius: 8px; box-shadow: 0 4px 20px rgba(0,0,0,0.3);">
            <div style="position: sticky; top: 0; background: #fff; padding: 15px 20px; border-bottom: 1px solid #ddd; display: flex; justify-content: space-between; align-items: center; border-radius: 8px 8px 0 0; z-index: 1;">
                <h3 style="margin: 0; font-size: 18px; color: #34495E;">Edit Product</h3>
                <button id="closeEditProductModal" style="background: none; border: none; font-size: 24px; cursor: pointer; color: #666; padding: 0; width: 30px; height: 30px; display: flex; align-items: center; justify-content: center;">&times;</button>
            </div>
            <div style="padding: 20px;">
                <form id="editProductForm" class="form-grid-2" style="margin-top:12px">
                    <div class="form-field">
                        <label for="edit-product-id">Product ID</label>
                        <input type="text" id="edit-product-id" readonly>
                    </div>

                    <div class="form-field">
                        <label for="edit-item-url">Website URL <span class="muted">(Must be unique)</span></label>
                        <input type="url" id="edit-item-url" placeholder="https://example.com/product-page" required>
                    </div>

                    <div class="form-field">
                        <label for="edit-product-name">Product Name</label>
                        <input type="text" id="edit-product-name" placeholder="e.g. Office PC 01" required>
                    </div>

                    <div class="form-field">
                        <label for="edit-type">Type</label>
                        <input type="text" id="edit-type" placeholder="e.g. Laptop, Desktop" required>
                    </div>

                    <div class="form-field">
                        <label for="edit-price">Price (INR)</label>
                        <input type="number" id="edit-price" placeholder="e.g. 105999.00" required min="0" step="0.01">
                    </div>
                    
                    <div class="form-field">
                        <label for="edit-gst">GST (%)</label>
                        <input type="number" id="edit-gst" placeholder="e.g. 18" min="0" max="100" step="0.01">
                    </div> 

                    <div class="form-field" style="grid-column: 1 / 3;">
                        <label for="edit-description">Description</label>
                        <textarea id="edit-description" placeholder="e.g. Core i7, 16GB RAM, 1TB SSD, RTX 3080"></textarea>
                    </div>

                    <div style="grid-column: 1 / 3; display:flex;justify-content:flex-end;gap:8px; margin-top: 10px;">
                        <button type="button" class="btn" id="cancelEditProductBtn">Cancel</button>
                        <button type="submit" class="btn primary">Update Product</button>
                    </div>
                </form>
            </div>
        </div>
    </div>

    <script src="https://cdnjs.cloudflare.com/ajax/libs/jspdf/2.5.1/jspdf.umd.min.js"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/html2canvas/1.4.1/html2canvas.min.js"></script>
            <script src="js/accountant.js"></script>

    </body>
</html>